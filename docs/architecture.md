# 架构说明文档

本文档详细说明了 DeepSeek OCR 应用的架构设计和实现细节。

## 目录
- [总体架构](#总体架构)
- [后端架构](#后端架构)
- [前端架构](#前端架构)
- [推理引擎](#推理引擎)
- [数据流](#数据流)
- [设计决策](#设计决策)

## 总体架构

DeepSeek OCR 采用前后端分离的架构：

```
┌─────────────────┐         ┌─────────────────┐
│                 │         │                 │
│   React 前端    │ ◄─────► │  FastAPI 后端   │
│   (Nginx)       │  HTTP   │   (Uvicorn)     │
│                 │         │                 │
└─────────────────┘         └────────┬────────┘
                                     │
                            ┌────────▼────────┐
                            │                 │
                            │  推理引擎       │
                            │  (vLLM)      │
                            │                 │
                            └────────┬────────┘
                                     │
                            ┌────────▼────────┐
                            │                 │
                            │  GPU + CUDA     │
                            │                 │
                            └─────────────────┘
```

## 后端架构

### 分层设计

后端采用经典的分层架构，职责清晰：

```
┌──────────────────────────────────────┐
│          API Layer (routes.py)        │  ◄── HTTP 请求入口
├──────────────────────────────────────┤
│       Service Layer (services/)       │  ◄── 业务逻辑
│  - model_manager.py                   │
│  - transformers_inference.py          │
│  - vllm_inference.py                  │
│  - prompt_builder.py                  │
│  - grounding_parser.py                │
├──────────────────────────────────────┤
│      Data Layer (models/schemas.py)   │  ◄── 数据模型
├──────────────────────────────────────┤
│      Config Layer (config.py)         │  ◄── 配置管理
└──────────────────────────────────────┘
```
